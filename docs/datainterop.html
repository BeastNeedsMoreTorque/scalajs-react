<html><head><title>scalajs-react: Data Interop</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="aappddeevv" /><meta name="description" content="A react integration library for scala.js in the spirit of ReasonReact" /><meta name="og:image" content="/scalajs-react/img/poster.png" /><meta name="og:title" content="scalajs-react: Data Interop" /><meta name="og:site_name" content="scalajs-react" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="A react integration library for scala.js in the spirit of ReasonReact" /><link rel="icon" type="image/png" href="/scalajs-react/img/favicon.png" /><meta name="twitter:title" content="scalajs-react: Data Interop" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="A react integration library for scala.js in the spirit of ReasonReact" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/scalajs-react/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/scalajs-react/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/scalajs-react/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/scalajs-react/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/scalajs-react/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/scalajs-react/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/scalajs-react/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/scalajs-react/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/scalajs-react/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/scalajs-react/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/scalajs-react/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/scalajs-react/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/scalajs-react/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/scalajs-react/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/scalajs-react/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/scalajs-react/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/scalajs-react/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/scalajs-react/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/scalajs-react/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/scalajs-react/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scalajs-react/highlight/styles/default.css" /><link rel="stylesheet" href="/scalajs-react/css/style.css" /><link rel="stylesheet" href="/scalajs-react/css/palette.css" /><link rel="stylesheet" href="/scalajs-react/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scalajs-react/" class="brand"><div class="brand-wrapper"><span>scalajs-react</span></div></a></li> <li><a href="/scalajs-react/docs/index.html" class="">Getting Started</a></li> <li><a href="/scalajs-react/docs/creating.html" class="">Creating scala.js Components</a></li> <li><a href="/scalajs-react/docs/importing.html" class="">Importing from JS</a></li> <li><a href="/scalajs-react/docs/exporting.html" class="">Exporting to JS</a></li> <li><a href="/scalajs-react/docs/styling.html" class="">Styling Suggestions</a></li> <li><a href="/scalajs-react/docs/vdom.html" class="">Virtual DOM</a></li> <li><a href="/scalajs-react/docs/redux.html" class="">Redux</a></li> <li><a href="/scalajs-react/docs/datainterop.html" class="">Data interop</a></li> <li><a href="/scalajs-react/docs/fabric.html" class="">office-fabric-ui-react</a></li> <li><a href="/scalajs-react/docs/mixedproject.html" class="">Mixed Projects</a></li> <li><a href="/scalajs-react/docs/reactinterop.html" class="">React Interop</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/aappddeevv/scalajs-react"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/aappddeevv/scalajs-react"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('scalajs-react A react integration library for scala.js in the spirit of ReasonReact');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('scalajs-react A react integration library for scala.js in the spirit of ReasonReact');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="aappddeevv" data-github-repo="scalajs-react"><div class="content-wrapper"><section><h1 id="data-interop">Data Interop</h1>
<p>Since there is an emphasis on interop with javascript reactjs components, you need to also interop with javascript data. Scala.js offers <code class="highlighter-rouge">js.UndefOr</code> to interop with fields in data structures that do not exist. Of course, in javascript a value can be undefined or null and sometimes they mean the same thing and sometimes not. Also, scala itself offers the ability to assign <code class="highlighter-rouge">null</code> (subclass of <code class="highlighter-rouge">Null</code>) to most values e.g. a String can be a value (“george”), empty (“”) or null.</p>

<p>The key message below is that even with a typescript description to guide you, you need to be defensive since null and undefined are often used interchangeably in javascript since its so easy to do <code class="highlighter-rouge">if(a) ...</code> and if a is null or undefined, it will evaluate to “false”.</p>

<h2 id="js---scala">JS -&gt; Scala</h2>
<p>Given that we also use native and non-native JS traits to describe the shape of data, we may wonder how to handle data from web apis, for example in the structure:</p>
<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">Foo</span> <span class="p">{</span> 
    <span class="nx">field1</span><span class="p">?:</span> <span class="kr">string</span>
    <span class="nx">field2</span><span class="p">?:</span> <span class="kr">string</span> <span class="o">|</span> <span class="kc">null</span>
<span class="p">}</span>
</code></pre>
</div>
<p>field1 can be undefined or a string and field2 can be a string value, undefined or null. Depending on the nature of the data source, you may encounter alot of field1 or field2 on some combination of that. For example, field1 could represent a value that is non-nullable in the source database but may not have been requested in a fetch and may not be present. field2 could represent a nullable field in the source database that was not requested or was requested and was null.</p>

<p>The question is how to best model these in scala so that we do not have to write an object conversion for each data structure. There was talk at one time to create a structure like UndefOr for nulls, <code class="highlighter-rouge">NullOr</code> however when you use a union type with null (whose type is Null), strange things can happen in scala’s type system, such as collapsing a <code class="highlighter-rouge">T|Null</code> to just T since a T can be null to begin with.</p>

<p>If you know the data is either there or not there, then UndefOr is fine:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">Foo</span> <span class="k">extends</span> <span class="n">js</span><span class="o">.</span><span class="nc">Object</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">field</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="c1">// var so mutable, use val for immutable
</span><span class="o">}</span>
</code></pre>
</div>
<p>However, if field can be null, undefined or a value what should we use? Consider:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">Foo</span> <span class="k">extends</span> <span class="n">js</span><span class="o">.</span><span class="nc">Object</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">field1</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
<span class="o">}</span>
</code></pre>
</div>
<p>Here, the value may not be present but it could be null, which is <em>different</em> then not being present. We could test:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">aFoo</span><span class="o">.</span><span class="n">field</span> <span class="o">==</span> <span class="kc">null</span>
</code></pre>
</div>
<p>which returns true or false depending on whether the value is null. scalajs-react provides a pimp:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">JsUndefOrOps</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">UndefOr</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">isNull</span>  <span class="k">=</span> <span class="n">a</span> <span class="o">==</span> <span class="kc">null</span>
  <span class="k">def</span> <span class="n">isEmpty</span> <span class="k">=</span> <span class="n">isNull</span> <span class="o">||</span> <span class="o">!</span><span class="n">a</span><span class="o">.</span><span class="n">isDefined</span>
<span class="o">}</span>
</code></pre>
</div>
<p>which can be implicitly used by importing the syntax so you can test:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="n">aBoolean</span> <span class="k">=</span> <span class="n">aFoo</span><span class="o">.</span><span class="n">field1</span><span class="o">.</span><span class="n">isNull</span> <span class="c1">// is it just null?
</span><span class="k">val</span> <span class="n">aBoolean2</span> <span class="k">=</span> <span class="n">afoo</span><span class="o">.</span><span class="n">field1</span><span class="o">.</span><span class="n">isEmpty</span> <span class="c1">// is it null or undefined
</span></code></pre>
</div>
<p>So we can test for null fairly easily given the <code class="highlighter-rouge">UndefOr</code> type definition. But we want to manipulate these things with some more functional syntax. For example, we would like an Option-based variant that is None if <code class="highlighter-rouge">isEmpty==true</code> and the value otherwise. Using <code class="highlighter-rouge">UndefOr.toOption</code> actually may wrap a “null” value and produce a <code class="highlighter-rouge">Some(null)</code> instead of None. So clearly, just using <code class="highlighter-rouge">.toOption</code> is not a good answer. So at the expense of a little boolean check, perhaps we could do something more convenient. Let’s state what we want, an Option that reflects both UndefOr and possible underlying null value:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">JsUndefOrOps</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">UndefOr</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span> <span class="o">{</span>
  <span class="nd">@inline</span> <span class="k">def</span> <span class="n">toNonNullOption</span> <span class="k">=</span> <span class="k">if</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="n">isEmpty</span><span class="o">)</span> <span class="nc">None</span> <span class="k">else</span> <span class="n">a</span><span class="o">.</span><span class="n">toOption</span>
<span class="o">}</span>
</code></pre>
</div>
<p>So now we can safely convert a UndefOr to an Option and have it be “null” if it is null or undefined and a Some with a non-null value otherwise. The cost you pay is a small conversion charge. So in general, it’s ok to model your data us UndefOr:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code> <span class="k">val</span> <span class="n">x</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">aFoo</span><span class="o">.</span><span class="n">field1</span><span class="o">.</span><span class="n">toNonNullOption</span>
</code></pre>
</div>
<p>Also, if you need to set data to null and the trait defines it as an UndefOr, just set it directly to null, just before you dispatch it javascript code:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code>  <span class="n">aFoo</span><span class="o">.</span><span class="n">field1</span> <span class="k">=</span> <span class="kc">null</span>
</code></pre>
</div>
<p>You should note that just declaring the attribute as a type:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>trait Foo extends js.Object {
  var field1: String
}
</code></pre>
</div>
<p>does not communicate that it can be null explicitly as in typescript. Perhaps, a <code class="highlighter-rouge">var field1: String|Null</code>. There’s nothing wrong with that except scala already defines that String to be potentially null so why go through the hassle!</p>

<p>If you see a trait with just a plain String and you want an Option just wrap it just like in, <code class="highlighter-rouge">Option(field1)</code> since Option translates null to None in plain scala to begin with.</p>

<h2 id="scala---js">Scala -&gt; JS</h2>
<p>The story is a bit easier on he Scala -&gt; JS connection. You generally need this when stuffing data into a data structured destined for the js side of the world.</p>

<ul>
  <li>Have (a: Option[T]):
    <ul>
      <li><code class="highlighter-rouge">a.orUndefined</code> yields an UndefOr which is the type that will probably be in most of your non-native JS traits</li>
      <li>Use <code class="highlighter-rouge">a.getOrElse(null)</code> to obtain the value or null for some non-native JS traits</li>
    </ul>
  </li>
  <li>Have (a: A):
    <ul>
      <li>Wrap it ala <code class="highlighter-rouge">js.defined(a)</code> to get an <code class="highlighter-rouge">UndefOr[A]</code></li>
      <li>If its a possibly null, you can wrap it in Option(a) then convert it as described above, however if your JS target is <code class="highlighter-rouge">A|null</code> then there is nothing you need to do as it scala and javascript both match the desired semantics.</li>
    </ul>
  </li>
</ul>

<h2 id="pimps">pimps</h2>
<p>Check out <a href="https://github.com/aappddeevv/scalajs-react/blob/master/scalajs-react-core/src/main/scala/syntax.scala">syntax.scala</a> for many pimps that you can apply to UndefOr values to help with data manipulation on the scala side. There’s alot there and its easy to forget them unless they are in a cheatsheet.</p>

<h2 id="dont-forget-about-a-structural-check">Don’t Forget About a Structural Check</h2>
<p>There is a little known converter in scala.js. If you have two traits that are not related but have overlapping fields, you may need to cast one to the other what is essentially a structural cast, check out <a href="https://www.scala-js.org/api/scalajs-library/latest/#scala.scalajs.js.package@use[A](x:A):scala.scalajs.js.Using[A]">funky structural cast-kindof</a>.</p>

<h2 id="tldr">TL;DR</h2>
<p>Let’s assume that typescript is not properly annotated and some undefineds and nulls get mixed up.</p>

<p>If your typescript says:</p>
<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="nx">field1</span><span class="p">?:</span> <span class="kr">string</span>
</code></pre>
</div>
<p>use this type of declaration in your trait:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">var</span><span class="o">/</span><span class="k">val</span> <span class="n">field1</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">undefined</span>
</code></pre>
</div>
<p>and use <code class="highlighter-rouge">field1 = null</code> if you want to set it to null or extract using <code class="highlighter-rouge">field1.toNonNullOption</code> to extract an option more safely than just <code class="highlighter-rouge">toOption</code> since the value could secretly be a null.</p>

<p>If typescript says:</p>
<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="nx">field1</span><span class="p">?:</span> <span class="kr">string</span><span class="o">|</span><span class="kc">null</span>
<span class="o">---</span>
<span class="nx">layout</span><span class="err">:</span> <span class="nx">docs</span>
<span class="nl">title</span><span class="p">:</span> <span class="nx">Creating</span> <span class="nx">Components</span>
<span class="o">---</span>
<span class="err">#</span> <span class="nx">Creating</span> <span class="nx">Components</span>
<span class="nx">Creating</span> <span class="nx">react</span> <span class="nx">components</span> <span class="k">in</span> <span class="nx">scalajs</span><span class="o">-</span><span class="nx">react</span> <span class="nx">uses</span> <span class="nx">a</span> <span class="s2">"builder"</span> <span class="kd">type</span> <span class="nx">pattern</span><span class="p">.</span> 

<span class="nx">In</span> <span class="nx">scala</span><span class="p">.</span><span class="nx">js</span><span class="p">,</span> <span class="nx">Component</span> <span class="k">is</span> <span class="nx">just</span> <span class="nx">a</span> <span class="s2">"data structure"</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">record</span> <span class="nx">really</span><span class="p">)</span> <span class="nx">that</span> <span class="nx">holds</span> <span class="nx">a</span> <span class="nx">few</span> <span class="nx">values</span> <span class="nx">and</span> <span class="nx">functions</span><span class="p">.</span> <span class="nx">A</span> <span class="nx">proxy</span> <span class="k">is</span> <span class="nx">setup</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">javascript</span> <span class="nx">side</span> <span class="nx">that</span> <span class="nx">forwards</span> <span class="nx">the</span> <span class="nx">react</span> <span class="nx">calls</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">scala</span> <span class="nx">side</span> <span class="nx">Component</span><span class="p">.</span> <span class="nx">You</span> <span class="nx">can</span> <span class="nx">create</span> <span class="nx">the</span> <span class="nx">Component</span> <span class="nx">almost</span> <span class="nx">anyway</span> <span class="nx">you</span> <span class="nx">want</span> <span class="nx">but</span> <span class="nx">some</span> <span class="nx">functions</span> <span class="nx">are</span> <span class="nx">provided</span> <span class="k">for</span> <span class="nx">convenience</span><span class="p">.</span> <span class="nx">It</span><span class="s1">'s important to realize that the type parameters you provide are very different than those provided to other scala.js react facades as the API is very different as well. For example, scalajs-react includes a simple router in every component. There is also no `setState` API. Instead this has been replaced by a fine state machine.

It'</span><span class="nx">s</span> <span class="nx">best</span> <span class="nx">to</span> <span class="nx">look</span> <span class="nx">to</span> <span class="nx">the</span> <span class="p">[</span><span class="nx">ReasonReact</span><span class="p">](</span><span class="nx">https</span><span class="err">:</span><span class="c1">//reasonml.github.io/reason-react) docs to understand the approach to creating Components in scala.js. It's pretty much the same approach.</span>


<span class="err">##</span> <span class="nx">Creating</span> <span class="nx">a</span> <span class="nx">Component</span>
<span class="nx">Here</span><span class="s1">'s a simple example that uses a non-native JS trait for the props:
```scala
// You can use individual props or a trait or a scala object.
// It'</span><span class="nx">s</span> <span class="nx">often</span> <span class="nx">convenient</span> <span class="nx">to</span> <span class="nx">use</span> <span class="nx">a</span> <span class="nx">subtype</span> <span class="nx">of</span> <span class="nx">js</span><span class="p">.</span><span class="nb">Object</span>
<span class="c1">// non-native JS trait</span>
<span class="nx">trait</span> <span class="nx">ToDoProps</span> <span class="k">extends</span> <span class="nx">js</span><span class="p">.</span><span class="nb">Object</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">todo</span><span class="err">:</span> <span class="nx">ToDo</span> <span class="c1">// has property "name"</span>
  <span class="kd">var</span> <span class="nx">remove</span><span class="err">:</span> <span class="nx">Unit</span> <span class="o">=&gt;</span> <span class="nx">Unit</span>
  <span class="c1">// look no children on this props...</span>
<span class="p">}</span>

<span class="nx">object</span> <span class="nx">ToDoC</span> <span class="p">{</span>
  <span class="nx">val</span> <span class="nx">ToDo</span> <span class="o">=</span> <span class="nx">statelessComponent</span><span class="p">(</span><span class="s2">"ToDo"</span><span class="p">)</span>
  <span class="c1">// def make(todo: ToDo, remove: Unit =&gt; Unit) =</span>
  <span class="c1">// or bundle them together into a trait</span>
  <span class="nx">def</span> <span class="nx">make</span><span class="p">(</span><span class="nx">props</span><span class="err">:</span> <span class="nx">ToDoProps</span><span class="p">)</span> <span class="o">=</span>
    <span class="nx">ToDo</span><span class="p">.</span>
      <span class="p">.</span><span class="nx">withRender</span><span class="p">{</span><span class="nx">self</span> <span class="o">=&gt;</span> 
        <span class="o">&lt;</span><span class="p">.</span><span class="nx">div</span><span class="p">(</span><span class="o">^</span><span class="p">.</span><span class="nx">style</span> <span class="err">:</span><span class="o">=</span> <span class="nx">Style</span><span class="p">(</span><span class="s2">"display"</span> <span class="err">:</span><span class="o">=</span> <span class="s2">"flex"</span><span class="p">))(</span>
          <span class="nx">Label</span><span class="p">()(</span><span class="s2">"Item:"</span><span class="p">),</span>
          <span class="nx">Label</span><span class="p">()(</span><span class="nx">props</span><span class="p">.</span><span class="nx">todo</span><span class="p">.</span><span class="nx">name</span><span class="p">),</span>
          <span class="nx">defaultButton</span><span class="p">(</span>
            <span class="nx">F</span><span class="p">.</span><span class="nx">text</span> <span class="err">:</span><span class="o">=</span> <span class="s2">"Remove"</span><span class="p">,</span>
            <span class="o">^</span><span class="p">.</span><span class="nx">onClick</span> <span class="o">==&gt;</span> <span class="p">((</span><span class="nx">_</span><span class="err">:</span> <span class="nx">ReactEvent</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">props</span><span class="p">.</span><span class="nx">remove</span><span class="p">(())))().</span><span class="nx">toEl</span><span class="p">)}</span>
<span class="p">}</span>
</code></pre>
</div>
<p>You can pass in children via your ToDoProps or just add them to the make call, if you need children. Here’s an example where they are passed in as a <code class="highlighter-rouge">js.Array[]</code>.</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="n">make</span><span class="o">(</span><span class="n">props</span><span class="k">:</span> <span class="kt">ToDoProps</span><span class="o">,</span> <span class="n">children</span><span class="k">:</span> <span class="kt">js.Array</span><span class="o">[</span><span class="kt">ReactNode</span><span class="o">])</span> <span class="k">=</span>
  <span class="nc">ToDo</span>
    <span class="o">.</span><span class="n">withRender</span><span class="o">{</span><span class="n">self</span> <span class="k">=&gt;</span>
    <span class="o">}</span>
</code></pre>
</div>
<p>Or you can use the spread approach:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="n">make</span><span class="o">(</span><span class="n">props</span><span class="k">:</span> <span class="kt">ToDoPropsp</span><span class="o">,</span> <span class="n">children</span><span class="k">:</span> <span class="kt">ReactNode*</span><span class="o">)</span> <span class="k">=</span>
  <span class="nc">ToDo</span>
    <span class="o">.</span><span class="n">withRendedr</span><span class="o">{</span><span class="n">self</span> <span class="k">=&gt;</span> 
    <span class="o">}</span>
</code></pre>
</div>
<h2 id="attributes">Attributes</h2>
<p>Notice that you can define your make function to take either a list of attributes or an object that bundles the attributes together. You can choose how you want to define the make parameters.</p>

<p>In scala if you define your non-native JS traits (you cannot instantiate a trait annotated with @js.native), then you can create them without having to use “override val” syntax:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">MyOpts</span> <span class="k">extends</span> <span class="n">js</span><span class="o">.</span><span class="nc">Object</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">prop1</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">undefined</span>
  <span class="k">var</span> <span class="n">prop2</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">undefined</span>
<span class="o">}</span>
</code></pre>
</div>
<p>Then you can do:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">new</span> <span class="nc">MyOpts</span> <span class="o">{</span> 
  <span class="n">prop1</span> <span class="k">=</span> <span class="s">"foo"</span><span class="o">,</span>
  <span class="n">prop2</span> <span class="k">=</span> <span class="s">"bar"</span>
<span class="o">}</span>
</code></pre>
</div>
<p>instead of:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">new</span> <span class="nc">MyOpts</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">val</span> <span class="n">prop1</span> <span class="k">=</span> <span class="s">"foo"</span>
  <span class="k">override</span> <span class="k">val</span> <span class="n">prop2</span> <span class="k">=</span> <span class="s">"bar"</span>
<span class="o">}</span>
</code></pre>
</div>
<p>In order to allow your props to contain other attributes, such as those from div, just have your props inherit from the appropriate attributes trait that is provided:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">MyOpts</span> <span class="k">extends</span> <span class="nc">HTMLAttributes</span><span class="o">[</span><span class="kt">dom.html.div</span><span class="o">]</span> <span class="o">{</span>
   <span class="c1">// your extra traits
</span><span class="o">}</span>
</code></pre>
</div>
<p>You may need to filter your props so you can access only your attributes. See office-ui-fabric-react for an example of a function that can do that filtering. There are many approaches to supporting this.</p>

<h2 id="children">Children</h2>
<p>Children in scalajs-react are ReactNode or ReactElement (subclass of ReactNode). Whatever you do, you need to take your imported react components, your scalajs-react components and convert them to a ReactNode in order to use them as children in other scalajs-react components. You have a few ways of doing this.</p>

<ul>
  <li>Explicitly using the API: <code class="highlighter-rouge">createElement(YourComponentC.make(...))</code></li>
  <li>Using syntax: <code class="highlighter-rouge">YourComponentC.make(..).toEl</code>.</li>
  <li>Implicit conversions: <code class="highlighter-rouge">YourComponentC.make(...)</code></li>
</ul>

<p>Note that every child must be converted to a <code class="highlighter-rouge">ReactNode</code> type, including strings and numbers. There are some functions for doing that:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="n">stringElement</span> <span class="k">=</span> <span class="n">stringToElement</span><span class="o">(</span><span class="s">"blah"</span><span class="o">)</span>
</code></pre>
</div>
<p>which can be quite verbose, hence the implicit conversions which will convert simple types to a <code class="highlighter-rouge">ReactNode</code>.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>Do the same thing as above because the first example was already doubly safe.

If typescript says:
```typescript
field1: string|null
</code></pre>
</div>
<p>use</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">var</span><span class="o">/</span><span class="k">val</span> <span class="n">field1</span><span class="k">:</span> <span class="kt">String</span>
</code></pre>
</div>
<p>and set it to null if you need to: <code class="highlighter-rouge">field1 = null</code>. If you want to have an option, use <code class="highlighter-rouge">Option(field1)</code>. You must use <code class="highlighter-rouge">Option</code> and not <code class="highlighter-rouge">Some</code> which would wrap a null value to <code class="highlighter-rouge">Some(null)</code>. To be extra safe use <code class="highlighter-rouge">toSafeOption</code> or the pimp from the react implicits <code class="highlighter-rouge">js.Any -&gt; Option</code> via <code class="highlighter-rouge">toNonNullOption</code>. You may need to provide a type parameter explicitly if type inference is insufficient.</p>

<p><code class="highlighter-rouge">toSafeOption</code> is defined in the react package object as follows which should automatically weed out the weird <code class="highlighter-rouge">Some(null)</code> and “its really undefined” problems:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code>  <span class="k">def</span> <span class="n">toSafeOption</span><span class="o">[</span><span class="kt">T</span> <span class="k">&lt;:</span> <span class="kt">js.Any</span><span class="o">](</span><span class="n">t</span><span class="k">:</span> <span class="kt">js.Any</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">js</span><span class="o">.</span><span class="n">isUndefined</span><span class="o">(</span><span class="n">t</span><span class="o">))</span> <span class="nc">None</span>
    <span class="k">else</span> <span class="nc">Option</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span>
  <span class="o">}</span>

</code></pre>
</div>

<p>Let’s hope the typescript interface descriptions are correct!</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scalajs-react/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/scalajs-react/js/main.js"></script></body></html>